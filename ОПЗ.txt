//ВОТ В СССР КОБАСА БЫЛА НАСТОЯЩАЯ ВКУСНАЯ И ПО ТРИ КОПЕЙКЕ, А СЕЙЧАС НЕТ ТАКОЙ КОЛБАСЫ.А ВОТ В СССР БЫЛА!!
//!ОХ, СУКА КАКАЯ ЖЕ БЫЛА КОЛБАСА В СССР
//!!!ПОТОМУ И ЖИЛИ ХОРОШО, ЧТО КОЛБАСА БЫЛА ХОРОШАЯ ДЕШЕВАЯ.ЭХ БЛЯ,
//А ВЫ С АЙФОНАМИ СВОИМИ НЕПОНИМАЕТЕ НИЧЕГО.ВОТ КОЛБААААСАААА РАНЬШЕ БЫЛА!!!!
//ПОНИМАЕШЬ ? К О Л Б А С А!!!КЭЙ ОУ ЭЛ БЭ ЭЙ СИ ЭЙ!!!!ШАРИШЬ!!!? ? ?
//КОЛБАСА РАНЬШЕ БЫЛА!!!ХОРОШАЯ, КОЛБАСОЧКА МОЯ, НЕ ТО, ЧТО СЕЙЧАС!!!
//ЭХ!!!КОЛБАСЮЛЕЧКА МОЯ, ДА РАСДЕШЕВЕНЬКАЯ МОЯ!!!!!
//ВОТ В СССР КОБАСА БЫЛА НАСТОЯЩАЯ ВКУСНАЯ И ПО ТРИ КОПЕЙКЕ, А СЕЙЧАС НЕТ ТАКОЙ КОЛБАСЫ.А ВОТ В СССР БЫЛА!!
//!ОХ, СУКА КАКАЯ ЖЕ БЫЛА КОЛБАСА В СССР
//!!!ПОТОМУ И ЖИЛИ ХОРОШО, ЧТО КОЛБАСА БЫЛА ХОРОШАЯ ДЕШЕВАЯ.ЭХ БЛЯ,
//А ВЫ С АЙФОНАМИ СВОИМИ НЕПОНИМАЕТЕ НИЧЕГО.ВОТ КОЛБААААСАААА РАНЬШЕ БЫЛА!!!!
//ПОНИМАЕШЬ ? К О Л Б А С А!!!КЭЙ ОУ ЭЛ БЭ ЭЙ СИ ЭЙ!!!!ШАРИШЬ!!!? ? ?
//КОЛБАСА РАНЬШЕ БЫЛА!!!ХОРОШАЯ, КОЛБАСОЧКА МОЯ, НЕ ТО, ЧТО СЕЙЧАС!!!
//ЭХ!!!КОЛБАСЮЛЕЧКА МОЯ, ДА РАСДЕШЕВЕНЬКАЯ МОЯ!!!!!
//ВОТ В СССР КОБАСА БЫЛА НАСТОЯЩАЯ ВКУСНАЯ И ПО ТРИ КОПЕЙКЕ, А СЕЙЧАС НЕТ ТАКОЙ КОЛБАСЫ.А ВОТ В СССР БЫЛА!!
//!ОХ, СУКА КАКАЯ ЖЕ БЫЛА КОЛБАСА В СССР
//!!!ПОТОМУ И ЖИЛИ ХОРОШО, ЧТО КОЛБАСА БЫЛА ХОРОШАЯ ДЕШЕВАЯ.ЭХ БЛЯ,
//А ВЫ С АЙФОНАМИ СВОИМИ НЕПОНИМАЕТЕ НИЧЕГО.ВОТ КОЛБААААСАААА РАНЬШЕ БЫЛА!!!!
//ПОНИМАЕШЬ ? К О Л Б А С А!!!КЭЙ ОУ ЭЛ БЭ ЭЙ СИ ЭЙ!!!!ШАРИШЬ!!!? ? ?
//КОЛБАСА РАНЬШЕ БЫЛА!!!ХОРОШАЯ, КОЛБАСОЧКА МОЯ, НЕ ТО, ЧТО СЕЙЧАС!!!
//ЭХ!!!КОЛБАСЮЛЕЧКА МОЯ, ДА РАСДЕШЕВЕНЬКАЯ МОЯ!!!!!
//ВОТ В СССР КОБАСА БЫЛА НАСТОЯЩАЯ ВКУСНАЯ И ПО ТРИ КОПЕЙКЕ, А СЕЙЧАС НЕТ ТАКОЙ КОЛБАСЫ.А ВОТ В СССР БЫЛА!!
//!ОХ, СУКА КАКАЯ ЖЕ БЫЛА КОЛБАСА В СССР
//!!!ПОТОМУ И ЖИЛИ ХОРОШО, ЧТО КОЛБАСА БЫЛА ХОРОШАЯ ДЕШЕВАЯ.ЭХ БЛЯ,
//А ВЫ С АЙФОНАМИ СВОИМИ НЕПОНИМАЕТЕ НИЧЕГО.ВОТ КОЛБААААСАААА РАНЬШЕ БЫЛА!!!!
//ПОНИМАЕШЬ ? К О Л Б А С А!!!КЭЙ ОУ ЭЛ БЭ ЭЙ СИ ЭЙ!!!!ШАРИШЬ!!!? ? ?
//КОЛБАСА РАНЬШЕ БЫЛА!!!ХОРОШАЯ, КОЛБАСОЧКА МОЯ, НЕ ТО, ЧТО СЕЙЧАС!!!
//ЭХ!!!КОЛБАСЮЛЕЧКА МОЯ, ДА РАСДЕШЕВЕНЬКАЯ МОЯ!!!!!
//ВОТ В СССР КОБАСА БЫЛА НАСТОЯЩАЯ ВКУСНАЯ И ПО ТРИ КОПЕЙКЕ, А СЕЙЧАС НЕТ ТАКОЙ КОЛБАСЫ.А ВОТ В СССР БЫЛА!!
//!ОХ, СУКА КАКАЯ ЖЕ БЫЛА КОЛБАСА В СССР
//!!!ПОТОМУ И ЖИЛИ ХОРОШО, ЧТО КОЛБАСА БЫЛА ХОРОШАЯ ДЕШЕВАЯ.ЭХ БЛЯ,
//А ВЫ С АЙФОНАМИ СВОИМИ НЕПОНИМАЕТЕ НИЧЕГО.ВОТ КОЛБААААСАААА РАНЬШЕ БЫЛА!!!!
//ПОНИМАЕШЬ ? К О Л Б А С А!!!КЭЙ ОУ ЭЛ БЭ ЭЙ СИ ЭЙ!!!!ШАРИШЬ!!!? ? ?
//КОЛБАСА РАНЬШЕ БЫЛА!!!ХОРОШАЯ, КОЛБАСОЧКА МОЯ, НЕ ТО, ЧТО СЕЙЧАС!!!
//ЭХ!!!КОЛБАСЮЛЕЧКА МОЯ, ДА РАСДЕШЕВЕНЬКАЯ МОЯ!!!!!
#define _CRT_SECURE_NO_WARNINGS
#include <iostream>
#include <cmath>
#include <random>
#include <string>
#include <windows.h>

using namespace std;

struct Numbers {
	double u;
	Numbers* next;
};

struct Symbols{
	char s;
	Symbols* next;
};

void InStack_N(Numbers**, double);
void InStack_S(Symbols**, char);
Symbols* pull_S(Symbols**);
Numbers* pull_N(Numbers**);
int prio(char);

void InStack_N(Numbers** p, double s) {
	Numbers* t = new Numbers;
	t->u = s;
	t->next = *p;
	*p = t;
}

void InStack_S(Symbols** p, char s) {
	Symbols* t = new Symbols;
	t->s = s;
	t->next = *p;
	*p = t;
}

Symbols* pull_S(Symbols** b) {
	Symbols* t = new Symbols;
	t = *b;
	*b = (*b)->next;
	return t;
}


int prio(char c) {
	switch (c) {
	case '/': return 2;
	case '*': return 2;
	case '+': return 1;
	case '-': return 1;
	case '(': return 0;
	case ')': return 3;
	default:return -1;
	}
}

void main()
{ 
	setlocale(LC_ALL, "Russian");
	SetConsoleCP(1251);
	int i = 0; string nac, OPZ, buf; Symbols* S = NULL, * k; Numbers* N = NULL; bool skoba = FALSE, prov = TRUE;
	while (true) {
		cout << "Введите выражение, либо \"STOP\" для завершения" << endl;
		cin >> nac; // =,- : 1    *, / : 2
		if (nac == "STOP") return;
		OPZ = "";
		while (nac[i] != '\0') {
			if ((nac[i] >= 'A' && nac[i] <= 'Z') ||( nac[i] >= 'a' && nac[i] <= 'z')) OPZ += nac[i];
			if (nac[i] == '/' || nac[i] == '*' || nac[i] == '+' || nac[i] == '-') {
				if (S == NULL || prio(S->s) < prio(nac[i])) InStack_S(&S, nac[i]);
				else {
					while (S != NULL && prio(S->s) >= prio(nac[i])) {
						k = pull_S(&S); OPZ += k->s; delete k;
					}
					InStack_S(&S, nac[i]);
				}
			}
			if (nac[i] == '(') { InStack_S(&S, nac[i]); skoba = TRUE; }
			if (nac[i] == ')') {
				if (!skoba) { cout << "Нет открывающей скобки!" << endl; prov = FALSE; break; }
				else {
					while (S->s != '(') { k = pull_S(&S);  OPZ += k->s; delete k; }
					if (S->s == '(') { k = S; S = S->next; delete k; }
				}
			}
			i++;

		}
		while (S != NULL) {
			if (S->s == '(') { cout << "Нет закрывающей скобки!" << endl; prov = FALSE; break; }
			else {
				k = pull_S(&S);  OPZ += k->s; delete k;
			}
		}
		if (!prov) cout << "Ошибка ввода!";
		else
			cout << OPZ<<endl;
	}
}